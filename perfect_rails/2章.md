# 第２章
## ActiveRecord
Active Recordとは、MVCで言うところのM、つまりモデルに相当するものであり、ビジネスデータとビジネスロジックを表すシステムの階層です。Active Recordは、データベースに恒久的に保存される必要のあるビジネスオブジェクトの作成と利用を円滑に行なえるようにします。Active Recordは、ORM (オブジェクト/リレーショナルマッピング) システムに記述されている「Active Recordパターン」を実装したものであり、このパターンと同じ名前が付けられています。
## ActiveRecord::Relation
SQLのそれぞれの表現に対応したメソッドをチェインさせることが可能。これらのインターフェイスをQueryInterfaceと呼ぶ。
・ActiveRecordに対してQueryInterfaceが呼ばれるとActive_record::Relationのインスタンスが生成される。
・ActiveRecord::Relationに対して繰り返しQueryInterfaceを呼び出すことができる。
・繰り返し呼び出したQueryInterfaceはActiveRecord::Relationのインスタンスに蓄積され、どんなSQLを発行するかの情報が更新されていく
・実際にデータが必要になった時点で、蓄積された情報を元にSQLを発行し、データを取得する。
## scope
Scopeとは、よく利用する検索条件に名前をつけてひとまとめにしたもの。
scopeで定義した検索条件がnilとなった場合、該当Scopeの検索条件を除外したクエリ（データベースへの問い合わせ）を発行し、必ずActiveRecord::Relationを返すため、注意が必要。

 ## リレーションの作成
 モデル同士の関連付けを行うことで、関連付けされたモデルを互いのモデルでメソッドとして扱うことができるようになる。
 多対多の関連付けはhas_many :モデル, through: :（中間テーブル名を定義）で行うことができる。中間テーブルはここで定義すれば勝手に作られる。

## ActiveRecord::Enum
数値と文字列をモデル内で関連付けさせることで、数値をデータベースに登録することで、関連づいた文字列が戻り値として返すことができる。
Enumを定義することで、メソッドの状態をtrueかfalseの状態が分かるようなメソッドが使えるようになる。
P74

