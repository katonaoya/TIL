# 6章
## ルーティング
```ruby
match '/login', to: 'sessions#create', via: [:post, :patch, :put]
```
とするとviaで指定されたメソッドでリクエストされた時にもsessionsコントローラーのcreateアクションが呼び出される。

## RESTful
### REST
1.HTTPリクエストはそのリクエストで必要な情報を全て持ち、前のリクエストからの状態が保存されている必要がない（ステートレス）  
**2.個々の情報（リソース）への「操作」の表現がHTTPメソッドとして統一されている。**  
3.個々の情報（リソース）がそれぞれ一意なURLで表されている。  
4.ある情報（リソース）から別の情報を参照したい時は、リンクを利用する。  
### RESTfulの特徴
○URLが表す情報（の１単位）のことをリソースと呼ぶ。例えば「/tasks/3というURLが表しているのは3という一意な識別子を持つtaskというリソースだ」と考える。  
○上記２の理由により、Railsでは、一般的なブラウザのサポートするGET/POSTの2種類だけでなく、（わざわざ_methodという特殊なリクエスパラメータを使ってまで）PATCH,PUT,DELETEといったHTTPメソッドをサポートする。
○上記２の理由により、RESTfulなシステムでは、操作はHTTPメソッドで表現するものであり、URLで表現するものではない。そのため、URLはなるべく、情報（リソース）の名前を表す形、すなわち「名詞」にするという発想で作られている。

## resources
```ruby
resources :tasks, only: [:index]
```
とするとindexのルートだけ作成することができる。
```ruby
resources :tasks, except:[:delete, :edit, :update]
```
とするとdelete,edit,update以外のルートを作成できる。

## routes.rbの構造化
○scope 
URL階層（:path）、モジュール（:module）、URLパターン名のプリフィックス（:as）などをオプションに指定することで、ブロック内の定義にまとめて一定の制約をかけます。  
○namespace  
URL階層、モジュール、URLパターン名に一括で一定の制約をかけます。scopeと違って一括なので、URL階層だけに制約をかけるといったことはできません。  
○controller  
コントローラを指定する。

```ruby
resources :photos, :books, :videos
```
このように１行でルーティングすることもできる。

```ruby
namespace :admin do
  resources :articles, :comments
end
```
|HTTP動詞|パス|コントローラ#アクション|名前付きルーティングヘルパー|
|---|---|---|---|
|GET|/admin/articles|admin/articles#index|admin_articles_path|
|GET|/admin/articles/new|admin/articles#new|new_admin_article_path|
|POST|/admin/articles|admin/articles#create|admin_articles_path|
|GET|/admin/articles/:id|admin/articles#show|admin_article_path(:id)|
|GET|/admin/articles/:id/edit|admin/articles#edit|edit_admin_article_path(:id)|
|PATCH/PUT|/admin/articles/:id|admin/articles#update|admin_article_path(:id)|
|DELETE|/admin/articles/:id|admin/articles#destroy|admin_article_path(:id)|

例外的に、(/adminが前についていない) /articlesをAdmin::ArticlesControllerにルーティングしたい場合は、以下のようにすることもできます。
```ruby
scope module: 'admin' do
  resources :articles, :comments
end
```
以下のようにブロックを使わない記述も可能です。
```ruby
resources :articles, module: 'admin'
```
```ruby
class Magazine < ApplicationRecord
  has_many :ads
end

class Ad < ApplicationRecord
  belongs_to :magazine
end
```
ルーティングをネストする (入れ子にする) ことで、この親子関係をルーティングで表すことができるようになります。上の例の場合、以下のようにルーティングを宣言することができます。
```ruby
resources :magazines do
  resources :ads
end
```
magazinesの中のads（広告）をルーティングできる。

## Strong Parameters
複数の属性を一括で代入することができる、マスアサインメント機能がモデルにはある。この機能があると、一度に複数の属性を取得することができる反面、意図しない属性も取得してしまう可能性があるので、Strong Parametersを使って、取得する属性を指定しておく。




